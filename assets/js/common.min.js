function formatFileSize(n){return typeof n!="number"?"":n>=1073741824?(n/1073741824).toFixed(2)+" GB":n>=1048576?(n/1048576).toFixed(2)+" MB":(n/1024).toFixed(2)+" KB"}function getAttachIcon(n){var t,i=n.split("."),r=i[i.length-1].toLowerCase();switch(r){case"xls":case"xlsx":t="file-excel-o";break;case"pdf":t="file-pdf-o";break;case"doc":case"docx":t="file-word-o";break;case"ppt":t="file-powerpoint-o";break;case"jpg":case"png":case"jpeg":case"bmp":case"gif":case"pic":case"tif":t="file-image-o";break;case"mp3":case"acm":case"aif":case"wav":case"mid":case"au":case"wma":case"ram":case"mmf":case"amr":case"aac":case"flac":t="file-sound-o";break;case"avi":case"mp4":case"flv":case"swf":case"mov":case"mpg":case"wmv":t="file-video-o";break;case"zip":case"rar":case"arj":case"gz":case"z":case"7z":t="file-zip-o";break;default:t="file-o"}return"fa fa-"+t+" "}function getDateDiff(n,t){var e;if(!t)return"";t=t.replace(/-/g,"/");var u=6e4,f=u*60,r=f*24,v=r*15,a=r*30,i="";if(n?(n=n.replace(/-/g,"/"),i=Date.parse(new Date(n))-Date.parse(new Date(t))):(e=(new Date).getTime(),i=e-Date.parse(new Date(t))),i<0)return"";var o=i/a,s=i/(7*r),h=i/r,c=i/f,l=i/u;return o>=1?parseInt(o)+"个月前":s>=1?parseInt(s)+"周前":h>=1?parseInt(h)+"天前":c>=1?parseInt(c)+"个小时前":l>=1?parseInt(l)+"分钟前":"刚刚"}function getDateTimeStamp(n){if(n)return Date.parse(n.replace(/-/gi,"/"))}function jqValidationShowErrors(n,t){return $.each(this.successList,function(n,t){return $(t).popover("hide")}),t&&t.length>0?$.each(t,function(n,t){var i,r;n===0&&(i=$(t.element).data("popover-placement"),i||(i="bottom"),r=$(t.element).popover({trigger:"manual",placement:i,content:t.message,template:'<div class="popover"><div class="arrow"><\/div><div class="popover-inner"><div class="popover-content"><p><\/p><\/div><\/div><\/div>'}),r.data("bs.popover").options.content=t.message,$("html,body").animate({scrollTop:$(t.element).offset().top},"fast",function(){return r.popover("show")}))}):void 0}function afterPaste(){}function elapsedDays(n){var t=n.substring(0,10).split("-"),i=new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]));return parseInt((new Date-i)/864e5)}function fitImage(n,t,i){var r=new Image;r.onload=function(){var e=1,u,f;if(r.width>0&&r.height>0){u=t/r.width;f=i/r.height;e=Math.abs(u-f)<.5?u<f?f:u:u<f?u:f;var o=Math.round(r.width*e),s=Math.round(r.height*e),h=Math.round((t-o)/2),c=Math.round((i-s)/2);n.css("position","absolute");n.css("max-width","100000px");n.css("width",o);n.css("height",s);n.css("left",h);n.css("top",c)}else n.css("width",t),n.css("height",i)};r.src=n.attr("src")}function checkIEVersion(){var t=!0,n,i;return $.browser.msie&&(n=0,$.browser.realVersion==11&&parseInt($.browser.version)<=7?n=2:$.browser.realVersion==10&&parseInt($.browser.version)<7?n=2:$.browser.realVersion==8&&parseInt($.browser.version)<7?n=2:$.browser.realVersion<8&&(n=1),n!=0&&(i='<div class="UpgradeIe"><div class="UpgradeIeIcon">   <img src="/webpub/Images/UpgradeIeIcon.jpg" alt="" /><\/div><div class="UpgradeIeText">你的IE浏览器版本低于8.0，页面显示不正常，请升级到最新版本。<\/div><div class="UpgradeDownload">   <a class="UpgradeIeA mr15" href="http://hq-fs1.chamc.com.cn/download/application/IE10-Windows6.1-x86-zh-cn.exe" target="_blank">IE10浏览器安装文件（32位）<\/a>   <a class="UpgradeIeA" href="http://hq-fs1.chamc.com.cn/download/application/IE10-Windows6.1-x64-zh-cn.exe" target="_blank">IE10浏览器安装文件（64位）<\/a><\/div><div class="UpgradeIeCloseIcon none">   <img src="/webpub/Images/UpgradeIeCloseIcon.jpg" alt="" /><\/div><\/div>',$("body").html(i),n==2?($(".UpgradeIe").show(),$(".UpgradeIeText").html("你的IE浏览器使用了低于IE8的兼容性视图，导致页面显示可能不正常，请与系统管理员联系。"),$(".UpgradeDownload").hide()):n==1&&$(".UpgradeIe").show(),t=!1)),t}function G(){return((1+Math.random())*65536|0).toString(16).substring(1)}function newGuid(){return(G()+G()+"-"+G()+"-"+G()+"-"+G()+"-"+G()+G()+G()).toUpperCase()}function getClientInfo(){var n={BrowserType:platform.name,BrowserVersion:platform.version,BrowserPlatform:platform.os.toString(),Screen:{Width:screen.width,Height:screen.height}};return JSON.stringify(n)}function AntiSqlInject(n){return/\b(=|'|\*|or|create|%|select|update|alter|and|insert|delete|drop|truncate|declare|join|union|exec|count)\b/i.test(n)}function pageVisited(){$.ajax({type:"post",url:dataServiceBaseUrl+"api/Common/Common/PageVisited?clientInfo="+getClientInfo()+"&sid="+sid,data:{RefererURL:document.referrer}})}function checkFileUploadState(){var n=$(".fileTable .files .template-upload .btn.start"),t;return n.length>0?(t=$(n[0]).popover({trigger:"manual",placement:"left",content:"文件未上传！",template:'<div class="popover"><div class="arrow"><\/div><div class="popover-inner"><div class="popover-content"><p><\/p><\/div><\/div><\/div>'}),t.data("bs.popover").options.content="文件未上传！",$("html").animate({scrollTop:$(n[0]).offset().top},"fast",function(){t.popover("show");$.each(n,function(n,t){if(n>0&&elementInViewport(t)){var i=$(t).popover({trigger:"manual",placement:"left",content:"文件未上传！",template:'<div class="popover"><div class="arrow"><\/div><div class="popover-inner"><div class="popover-content"><p><\/p><\/div><\/div><\/div>'});i.data("bs.popover").options.content="文件未上传！";i.popover("show")}})}),!1):!0}function elementInViewport(n){var t=n.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=getHeight()&&t.right<=getWidth()}function getHeight(){return window.innerHeight?window.innerHeight:Math.min(document.documentElement.clientHeight,document.body.clientHeight)}function getWidth(){return window.innerWidth?window.innerWidth:Math.min(document.documentElement.clientWidth,document.body.clientWidth)}function hideReadFlag(n,t){var i,e,u,r,o,f;switch(t){case 1:i=$("#newsList").length===1?$(".newsInfo .panel-body"):$(".dataList");break;case 2:i=$("#productList").length===1?$(".productInfo .panel-body"):$(".dataList");break;case 3:i=$("#projectList").length===1?$(".projectInfo .panel-body"):$(".dataList");break;case 4:i=$(".dataList");break;case 5:i=$(".dataList");break;default:return}if(i&&i.length===1&&(e=i.find('.table-container .table-content-container .table-row[data-moduletype="'+t+'"][data-id="'+n+'"]'),e&&e.length===1&&(u=e.find(".ReadFlag"),u.length===1&&u.is(":visible")&&u.html()!=""&&(u.empty(),r=i.find(".table-container .table-content-container .table-row .ReadFlag"),r&&r.length>0)))){for(o=!0,f=0;f<r.length;f++)if($(r[f]).is(":visible")&&$(r[f]).html()!=""){o=!1;break}o===!0&&i.GWDataTable("hideColumn","ReadFlag")}}function setTitleClass(n){$(n).find(".table-row a").each(function(){var n=$(this).data("titleclass");n&&($(this).outerWidth()+13>=$(this).parent().width()-16?($(this).removeClass(n),$(this).parent().addClass(n)):($(this).addClass(n),$(this).parent().removeClass(n)))})}function downLoadFile(n){return $("#hidFileFrame").attr("src",$(n).data("downloadurl")),!1}function bindFileList(n,t,i){var r,f,u;if(i&&i.length>0){for(r=0;r<i.length;r++)f="",t===1?(u=i[r].FileExtType.toLowerCase(),f=u=="jpg"||u=="jpeg"||u=="png"||u=="bmp"||u=="pic"||u=="tif"?'<a data-lightbox="{0}" data-title="{1}" title="{1}" href="{2}">{3}<\/a>'.format(n,i[r].OriginFileName,dataServiceBaseUrl+"api/Common/FileManage?ids={0}&sid={1}".format(i[r].FileID,sid),i[r].OriginFileName+"（"+formatFileSize(i[r].FileLength)+"）"):u!="pdf"||$.browser&&$.browser.msie&&parseInt($.browser.version)<9?'<span title="{0}" onclick="{1}">{2}<\/span>'.format(i[r].OriginFileName,"downloadFile("+i[r].FileID+");",i[r].OriginFileName+"（"+formatFileSize(i[r].FileLength)+"）"):'<a title="{0}" href="{1}" target="_blank">{2}<\/a>'.format(i[r].OriginFileName,"../../../assets/vendors/pdf.js/web/viewer.html?fileId="+i[r].FileID+"&fileName="+encodeURIComponent(i[r].OriginFileName),i[r].OriginFileName+"（"+formatFileSize(i[r].FileLength)+"）")):f='<span title="{0}">{1}<\/span>'.format(i[r].OriginFileName,i[r].OriginFileName+"（"+formatFileSize(i[r].FileLength)+"）"),$("."+n+" .attachList").append('<div data-fileid="'+i[r].FileID+'"><i class="'+getAttachIcon(i[r].FileExtType)+'"><\/i>'+f+"<\/div>");$("."+n).show()}}function loadDiscussInfo(n,t){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/GetDiscussInfo?moduleTypeKV="+n+"&itemId="+t+"&sid="+sid,type:"get",async:!0,cache:!1,success:function(i){var u,r;i&&i.Success===!0&&i.Data?($(".questionList .head .statistics").data("questioncount",i.Data.DiscussInfo.questionCount),$(".questionList .head .statistics").data("answercount",i.Data.DiscussInfo.answerCount),$(".questionList .head .statistics").html("{0}提问&nbsp;&nbsp;·&nbsp;&nbsp;{1}回复".format(i.Data.DiscussInfo.questionCount,i.Data.DiscussInfo.answerCount)),$(".questionList .questionListDetail").empty(),i.Data.DiscussInfo.rows.length>0&&($(i.Data.DiscussInfo.rows).each(function(){var n=this,f=$('<div class="questionDetail"><\/div>'),r=$('<div class="question" data-questionid="'+n.QuestionID+'"><\/div>'),e="",t,u;n.IsQuestionCreateUser!==1||n.AnswerID||(e='<a class="modify ml10">修改<\/a><a class="cancel ml10 none">取消<\/a><a class="delete ml10">删除<\/a>');r.append('<div><span class="font14 black">问题：<\/span><span class="toolbar">'+e+"<\/span><\/div>");r.append('<div class="questionContent"><div class="showContent">'+n.QuestionContent+"<\/div>"+(e?'<textarea class="form-control editContent" rows="3" maxlength="200" placeholder="在此输入问题内容..."><\/textarea>':"")+"<\/div>");r.append('<div class="textRight"><span>'+n.QuestionCreateUserName+'<\/span><span class="ml10">'+getDateDiff(i.Data.CurrentDateTime,n.QuestionLastModifyTime)+"<\/span><\/div>");f.append(r);(n.AnswerID||i.Data.HasAnswerRight===!0)&&(t=$('<div class="answer" data-answerid="'+(n.AnswerID?n.AnswerID:0)+'"><\/div>'),u="",n.AnswerID&&n.IsAnswerCreateUser===1&&(u='<a class="modify ml10">修改<\/a><a class="cancel ml10 none">取消<\/a><a class="delete ml10">删除<\/a>'),n.AnswerID||(u='<a class="modify ml10">回复<\/a><a class="cancel ml10 none">取消<\/a><a class="delete ml10 none">删除<\/a>'),t.append('<div><span class="font14 black">#答复：<\/span><span class="toolbar">'+u+"<\/span><\/div>"),t.append('<div class="answerContent"><div class="showContent">'+(n.AnswerContent?n.AnswerContent:"")+"<\/div>"+(n.IsAnswerCreateUser===1||!n.AnswerID?'<textarea class="form-control editContent" rows="3" maxlength="500" placeholder="在此输入回复内容..."><\/textarea>':"")+"<\/div>"),n.AnswerID?t.append('<div class="textRight"><span>'+n.AnswerCreateUserName+'<\/span><span class="ml10">'+getDateDiff(i.Data.CurrentDateTime,n.AnswerLastModifyTime)+"<\/span><\/div>"):t.append('<div class="textRight none"><span>'+i.Data.UserName+'<\/span><span class="ml10">刚刚<\/span><\/div>'),f.append(t));$(".questionList .questionListDetail").append(f)}),$(".questionList .questionListDetail .questionDetail").each(function(){var i=$(this);i.find(".question .modify").on("click",function(){var r=this,f=$(r).parent().parent().parent().data("questionid"),u;$(r).text()==="修改"?(u=i.find(".questionContent .showContent").hide().text().trim(),i.find(".questionContent .editContent").show().focus().val(u),$(r).text("确定"),$(r).next().show(),$(r).next().next().hide()):(u=i.find(".questionContent .editContent").val().trim(),u&&updateQuestion(f,u,function(f){f==="answerd"?loadDiscussInfo(n,t):(i.find(".questionContent .editContent").hide(),i.find(".questionContent .showContent").text(u).show(),$(r).text("修改"),$(r).next().hide(),$(r).next().next().show(),$(r).parent().parent().next().next().find(".ml10").text("刚刚"))}))});i.find(".answer .modify").on("click",function(){var r=this,f=$(r).parent().parent().parent().prev().data("questionid"),u;$(r).text()==="回复"?(i.find(".answerContent .showContent").hide(),i.find(".answerContent .editContent").val("").show().focus(),$(r).data("mode","add"),$(r).text("确定"),$(r).next().show()):$(r).text()==="确定"?$(r).data("mode")==="add"?(u=i.find(".answerContent .editContent").val().trim(),u&&addAnswer(n,t,f,u,function(n){var t,f;$(r).parent().parent().parent().data("answerid",n);i.find(".answerContent .editContent").hide();i.find(".answerContent .showContent").text(u).show();$(r).text("修改");$(r).next().hide();$(r).next().next().show();$(r).parent().parent().next().next().find(".ml10").text("刚刚");$(r).parent().parent().next().next().show();t=$(".questionList .head .statistics").data("questioncount");$(".questionList .head .statistics").data("questioncount",t);f=parseInt($(".questionList .head .statistics").data("answercount"))+1;$(".questionList .head .statistics").data("answercount",f);$(".questionList .head .statistics").html("{0}提问&nbsp;&nbsp;·&nbsp;&nbsp;{1}回复".format(t,f))})):$(r).data("mode")==="update"&&(u=i.find(".answerContent .editContent").val().trim(),u&&updateAnswer($(r).parent().parent().parent().data("answerid"),u,function(){i.find(".answerContent .editContent").hide();i.find(".answerContent .showContent").text(u).show();$(r).text("修改");$(r).next().hide();$(r).next().next().show()})):$(r).text()==="修改"&&(u=i.find(".answerContent .showContent").hide().text().trim(),i.find(".answerContent .editContent").show().focus().val(u),$(r).data("mode","update"),$(r).text("确定"),$(r).next().show(),$(r).next().next().hide())});i.find(".question .cancel").on("click",function(){var n=this;i.find(".questionContent .showContent").show();i.find(".questionContent .editContent").hide();$(n).prev().text("修改");$(n).hide();$(n).next().show()});i.find(".answer .cancel").on("click",function(){var n=this;i.find(".answerContent .showContent").show();i.find(".answerContent .editContent").hide();$(n).prev().data("mode")==="add"?$(n).prev().text("回复"):$(n).prev().data("mode")==="update"&&($(n).prev().text("修改"),$(n).next().show());$(n).hide()});i.find(".question .delete").on("click",function(){var i=this;bootbox.confirm({message:"确定要删除吗？",size:"small",callback:function(r){if(r===!0){var u=$(i).parent().parent().parent().data("questionid");deleteQuestion(u,function(r){var u,f;r==="answerd"?loadDiscussInfo(n,t):($(i).parent().parent().parent().parent().remove(),u=parseInt($(".questionList .head .statistics").data("questioncount"))-1,$(".questionList .head .statistics").data("questioncount",u),f=$(".questionList .head .statistics").data("answercount"),$(".questionList .head .statistics").data("answercount",f),$(".questionList .head .statistics").html("{0}提问&nbsp;&nbsp;·&nbsp;&nbsp;{1}回复".format(u,f)))})}}})});i.find(".answer .delete").on("click",function(){var n=this;bootbox.confirm({message:"确定要删除吗？",size:"small",callback:function(t){if(t===!0){var i=$(n).parent().parent().parent().data("answerid");deleteAnswer(i,function(){var t,i;$(n).hide();$(n).prev().prev().text("回复");$(n).parent().parent().next().find(".showContent").text("");$(n).parent().parent().next().next().hide();t=$(".questionList .head .statistics").data("questioncount");$(".questionList .head .statistics").data("questioncount",t);i=parseInt($(".questionList .head .statistics").data("answercount"))-1;$(".questionList .head .statistics").data("answercount",i);$(".questionList .head .statistics").html("{0}提问&nbsp;&nbsp;·&nbsp;&nbsp;{1}回复".format(t,i))})}}})})}),u=$.url().fparam("qid"),u&&(r=$(".questionList .questionListDetail").find('.questionDetail .question[data-questionid="'+u+'"]'),r&&r.length===1&&($.browser&&$.browser.msie&&parseInt($.browser.version)===8?setTimeout(function(){$("html,body").animate({scrollTop:$(r).offset().top-5},0,function(){$(r).parent().addClass("questionFocus")})},500):$("html,body").animate({scrollTop:$(r).offset().top-5},0,function(){$(r).parent().addClass("questionFocus")})),window.opener!=null&&window.opener!=undefined&&(typeof window.opener.refreshQuestionCount=="function"||typeof window.opener.refreshQuestionCount=="object")&&window.opener.refreshQuestionCount()))):bootbox.alert({message:"加载问题列表失败！"})},error:function(){bootbox.alert({message:"加载问题列表失败！"})}})}function addQuestion(n,t){var i=$("#txtQuestionContent").val().trim();i&&$.ajax({url:dataServiceBaseUrl+"api/Common/Common/AddQuestion?sid="+sid,type:"post",data:{ModuleTypeKV:n,ItemID:t,QuestionContent:filterXSS(i)},async:!0,cache:!1,success:function(i){i&&i.Success===!0&&i.Data>0?($("#txtQuestionContent").val(""),loadDiscussInfo(n,t),window.opener!=null&&window.opener!=undefined&&(typeof window.opener.refreshAnswerCount=="function"||typeof window.opener.refreshAnswerCount=="object")&&window.opener.refreshAnswerCount()):i.Message==="NoPermisson"||i.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":i.Message==="NotAllowed"?bootbox.alert({message:"当前状态不可以提问！"}):bootbox.alert({message:"提交失败！"})},error:function(){bootbox.alert({message:"提交失败！"})}})}function updateQuestion(n,t,i){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/UpdateQuestion?sid="+sid,type:"put",data:{ID:n,QuestionContent:filterXSS(t)},async:!0,cache:!1,success:function(n){n&&n.Success===!0&&n.Data===0?i():n.Message==="NoPermisson"||n.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":n.Message==="Answerd"?(bootbox.alert({message:"问题已经被回复，修改失败！"}),i("answerd")):bootbox.alert({message:"提交失败！"})},error:function(){bootbox.alert({message:"提交失败！"})}})}function deleteQuestion(n,t){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/DeleteQuestion?sid="+sid,type:"delete",data:{ID:n},async:!0,cache:!1,success:function(n){n&&n.Success===!0&&n.Data===0?(t(),window.opener!=null&&window.opener!=undefined&&(typeof window.opener.refreshAnswerCount=="function"||typeof window.opener.refreshAnswerCount=="object")&&window.opener.refreshAnswerCount()):n.Message==="NoPermisson"||n.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":n.Message==="Answerd"?(bootbox.alert({message:"问题已经被回复，删除失败！"}),t("answerd")):bootbox.alert({message:"删除失败！"})},error:function(){bootbox.alert({message:"删除失败！"})}})}function addAnswer(n,t,i,r,u){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/AddAnswer?sid="+sid,type:"post",data:{ModuleTypeKV:n,ItemID:t,QuestionID:i,AnswerContent:filterXSS(r)},async:!0,cache:!1,success:function(n){n&&n.Success===!0&&n.Data>0?(u(n.Data),window.opener!=null&&window.opener!=undefined&&(typeof window.opener.refreshAnswerCount=="function"||typeof window.opener.refreshAnswerCount=="object")&&window.opener.refreshAnswerCount()):n.Message==="NoPermisson"||n.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":n.Message==="Answerd"?bootbox.alert({message:"问题已经被其它人回复，提交失败！"}):bootbox.alert({message:"提交失败！"})},error:function(){bootbox.alert({message:"提交失败！"})}})}function updateAnswer(n,t,i){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/UpdateAnswer?sid="+sid,type:"put",data:{ID:n,AnswerContent:filterXSS(t)},async:!0,cache:!1,success:function(n){n&&n.Success===!0&&n.Data===0?i():n.Message==="NoPermisson"||n.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":bootbox.alert({message:"提交失败！"})},error:function(){bootbox.alert({message:"提交失败！"})}})}function deleteAnswer(n,t){$.ajax({url:dataServiceBaseUrl+"api/Common/Common/DeleteAnswer?sid="+sid,type:"delete",data:{ID:n},async:!0,cache:!1,success:function(n){n&&n.Success===!0&&n.Data===0?(t(),window.opener!=null&&window.opener!=undefined&&(typeof window.opener.refreshAnswerCount=="function"||typeof window.opener.refreshAnswerCount=="object")&&window.opener.refreshAnswerCount()):n.Message==="NoPermisson"||n.Message==="InvalidUser"?window.location.href="../Common/NoRight.html":bootbox.alert({message:"删除失败！"})},error:function(){bootbox.alert({message:"删除失败！"})}})}function downloadFile(n){var t=dataServiceBaseUrl+"api/Common/FileManage?ids={0}&sid={1}".format(n,sid);$("#hidFileFrame").attr("src",t)}function openUserProfile(n){var t=document.getElementById("userProfileModal"),i="../Common/UserProfile.html?userAccountId="+n+"&t="+(new Date).getMilliseconds();t?$(t).find("iframe").attr("src",i):(t='<div class="modal fade" id="userProfileModal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><iframe src="'+i+'" frameborder="0" style="border-radius: 8px;"><\/iframe><\/div><\/div><\/div><\/div>',$("body").append(t));$("#userProfileModal").modal()}function closeUserProfile(){$("#userProfileModal").modal("hide")}Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1});Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")});String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})});Date.prototype.toISOString||function(){function n(n){var t=String(n);return t.length===1&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+n(this.getUTCMonth()+1)+"-"+n(this.getUTCDate())+"T"+n(this.getUTCHours())+":"+n(this.getUTCMinutes())+":"+n(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}();Date.prototype.Format||(Date.prototype.Format=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},t;/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(t in i)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?i[t]:("00"+i[t]).substr((""+i[t]).length)));return n});window.onload=function(){document.onkeydown=function(n){var i=window.event||n,t;return i.altKey&&(i.keyCode==37||i.keyCode==39)?!1:i.keyCode==8?(t=document.activeElement,(t.type=="text"||t.type=="password"||t.type=="textarea"||t.type=="search")&&t.readOnly==!1&&t.disabled==!1?!0:!1):void 0}};var HtmlEncode=function(n){function e(n){var u=!0,r=n.charCodeAt(0),i,f,e,o,s;switch(r){case 10:return"<br/>";case 32:return"&nbsp;";case 34:return"&quot;";case 38:return"&amp;";case 39:return"&#x27;";case 47:return"&#x2F;";case 60:return"&lt;";case 62:return"&gt;";case 198:return"&AElig;";case 193:return"&Aacute;";case 194:return"&Acirc;";case 192:return"&Agrave;";case 197:return"&Aring;";case 195:return"&Atilde;";case 196:return"&Auml;";case 199:return"&Ccedil;";case 208:return"&ETH;";case 201:return"&Eacute;";case 202:return"&Ecirc;";case 200:return"&Egrave;";case 203:return"&Euml;";case 205:return"&Iacute;";case 206:return"&Icirc;";case 204:return"&Igrave;";case 207:return"&Iuml;";case 209:return"&Ntilde;";case 211:return"&Oacute;";case 212:return"&Ocirc;";case 210:return"&Ograve;";case 216:return"&Oslash;";case 213:return"&Otilde;";case 214:return"&Ouml;";case 222:return"&THORN;";case 218:return"&Uacute;";case 219:return"&Ucirc;";case 217:return"&Ugrave;";case 220:return"&Uuml;";case 221:return"&Yacute;";case 225:return"&aacute;";case 226:return"&acirc;";case 230:return"&aelig;";case 224:return"&agrave;";case 229:return"&aring;";case 227:return"&atilde;";case 228:return"&auml;";case 231:return"&ccedil;";case 233:return"&eacute;";case 234:return"&ecirc;";case 232:return"&egrave;";case 240:return"&eth;";case 235:return"&euml;";case 237:return"&iacute;";case 238:return"&icirc;";case 236:return"&igrave;";case 239:return"&iuml;";case 241:return"&ntilde;";case 243:return"&oacute;";case 244:return"&ocirc;";case 242:return"&ograve;";case 248:return"&oslash;";case 245:return"&otilde;";case 246:return"&ouml;";case 223:return"&szlig;";case 254:return"&thorn;";case 250:return"&uacute;";case 251:return"&ucirc;";case 249:return"&ugrave;";case 252:return"&uuml;";case 253:return"&yacute;";case 255:return"&yuml;";case 162:return"&cent;";case"\r":break;default:u=!1}if(!u)return r>127?(i=r,f=i%16,i=Math.floor(i/16),e=i%16,i=Math.floor(i/16),o=i%16,i=Math.floor(i/16),s=i%16,"&#x"+t[s]+t[o]+t[e]+t[f]+";"):n}for(var f,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],u=n,i="",r=0;r<u.length;r++)f=u.charAt(r),i=i+e(f);return i};