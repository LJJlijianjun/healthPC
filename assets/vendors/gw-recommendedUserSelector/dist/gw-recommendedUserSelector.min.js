(function(n){window.addRecommendedUserToList=function(t){n("#btnClose"+t+"Modal").click();n("body").loadingUI({text:"数据加载中..."})};n.fn.GWRecommendedUserSelector=function(t){var i={selectOrgOrUser:1,isMultiSelect:!0,selectorPath:"",orgRootId:0},r=arguments,u=this;return this.each(function(){var r=n(this),u=n.extend(i,t),o=function(){n("#"+r[0].id+"Frame",r.parent()).attr("src",u.selectorPath+"?selectOrgOrUser="+u.selectOrgOrUser+"&selectedItems="+r.val()+"&isMultiSelect="+(u.isMultiSelect?2:1)+"&orgRootId="+u.orgRootId+"&inputId="+r[0].id+"&g="+newGuid());n("#"+r[0].id+"Modal",r.parent()).modal({backdrop:"static",keyboard:!1})},s=function(){if(u.selectorPath==""||!u.selectorPath)return!1;r.parent().append(n('<div class="modal fade GWRecommendedUserSelectorModal" id="'+r[0].id+'Modal" tabindex="-1" role="dialog" aria-labelledby="'+r[0].id+'Modal" aria-hidden="true"> <div class="modal-dialog"><div class="modal-content"> <div class="modal-body">  <button class="close btnColseGWRecommendedUserSelectorModal" id="btnClose'+r[0].id+'Modal" title="关闭" data-dismiss="modal" type="button"  aria-hidden="true">&times;<\/button>     <iframe class="GWRecommendedUserSelectorFrame" id="'+r[0].id+'Frame" ><\/iframe>  <\/div> <\/div><\/div><\/div>'));r.parent().append('<span class="input-group-btn"><button class="btn btn-default btnToSelect"><i class="fa fa-plus"><\/i>&nbsp;选择<\/button><\/span>');u.selectOrgOrUser==1?h():u.selectOrgOrUser==2&&c()},h=function(){r.tagsinput({itemValue:"OrgEmpId",itemText:"UserName",tagClass:function(){return"label label-info"}});r.val("");r.prev().find("input").css("width",55).prop("readonly",!0)},c=function(){r.tagsinput({itemValue:"OrgId",itemText:"OrgName",tagClass:function(){return"label label-info"}});r.prev().find("input").css("width",50).prop("readonly",!0)},f=0,e=function(t,i){i.length>0?(n(".bootstrap-tagsinput input",n("#"+t).parent()).focus(),f<i.length&&(n("#"+t).tagsinput("add",i[f]),setTimeout(function(){f>=i.length-1?(n(".bootstrap-tagsinput input",n("#"+t).parent()).blur(),n("body").loadingUI("hide")):(f=f+1,e(t,i))},20))):setTimeout(function(){n(".bootstrap-tagsinput input",n("#"+t).parent()).blur();n("body").loadingUI("hide")},20)},l=function(){n(".btnToSelect",r.parent()).on("click",function(){return o(),!1});n("#"+r[0].id+"Modal").on("hidden.bs.modal",function(){var t=r[0].id,i=document.getElementById(t+"Frame").contentWindow.getSelectedItems(),u=document.getElementById(t+"Frame").contentWindow.getAffirmClickSource();u==1&&(n("#"+t).tagsinput("removeAll"),f=0,e(t,i))})};s();l()})}})(jQuery);