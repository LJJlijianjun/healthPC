<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>我的提问</title>
    <meta charset="utf-8" />
    <link href="../../assets/css/base.css" rel="stylesheet" />
    <link href="../../assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/LoadingUI/jquery.loadingui.css" rel="stylesheet" />
    <link href="../../assets/vendors/gw-dataTable/dist/gw-dataTable.min.css?v=1.0.1" rel="stylesheet" />
    <link href="../../assets/css/common.min.css?v=1.0.2" rel="stylesheet" />
    <link href="../../assets/css/page.min.css?v=1.0.2" rel="stylesheet" />
</head>
<body>
    <div class="myWork-todoList">
        <div class="dataList">
        </div>
    </div>
    <script src="../../assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="../../assets/js/jquery-tools-min.js" type="text/javascript"></script>
    <script src="../../assets/js/config.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/js/auth.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/LoadingUI/jquery.loadingui.js"></script>
    <script src="../../assets/vendors/twbs-pagination/jquery.twbsPagination.js"></script>
    <script src="../../assets/vendors/gw-dataTable/dist/gw-dataTable.min.js?v=1.0.1"></script>
    <script src="../../assets/js/common.min.js?v=1.0.3" type="text/javascript"></script>
    <script src="../../assets/vendors/bootbox.js/bootbox.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            AuthUtility.Auth(function () {
                searchWaitingToAnswerList();
            });
        });

        function searchWaitingToAnswerList() {
            $('.dataList').css('height', $('.myWork-todoList').height() - 34);
            $('.dataList').GWDataTable({
                dataUrl: dataServiceBaseUrl + 'api/Common/Common/GetMyQuestionList?sid=' + sid,
                tableTitle: '我的提问',
                tableIcon: true,
                pagination: true,
                queryParams: function (pageNumber, pageSize) {
                    return { scModel: { PageNum: pageNumber, PageSize: pageSize } };
                },
                columns:
                [
                    {
                        title: '',
                        field: 'HasRead',
                        width: '23',
                        align: 'left',
                        hidden: function (rows) {
                            for (var i = 0; i < rows.length; i++) {
                                if (rows[i].HasRead === 0) {
                                    return false;
                                }
                            }
                            return true;
                        },
                        styler: function () {
                            return 'padding-right: 0px; padding-bottom: 2px; font-size: 14px;';
                        },
                        formatter: function (value) {
                            return value === 0 ? '<span class="fa fa-envelope-o cp"></span>' : '';
                        }
                    },
                    {
                        title: '标题',
                        field: 'Title',
                        align: 'left',
                        formatter: function (value, row) {
                            var linkTitle = 'javascript:void(0);';
                            switch (row.ModuleTypeKV) {
                                case 2:
                                    linkTitle = '../ProductInfo/Read.html#id=' + row.ItemID + '&qid=' + row.QuestionID;
                                    break;
                                case 3:
                                    linkTitle = '../ProjectInfo/Read.html#id=' + row.ItemID + '&qid=' + row.QuestionID;
                                    break;
                                case 4:
                                    linkTitle = '../CaseInfo/Read.html#id=' + row.ItemID + '&qid=' + row.QuestionID;
                                    break;
                                case 5:
                                    linkTitle = '../FileInfo/Read.html#id=' + row.ItemID + '&qid=' + row.QuestionID;
                                    break;
                                default:
                                    break;
                            }
                            return '<a href="' + linkTitle + '" target="_blank" title="' + row.Title + '" onclick="javascript: void(0);">' + row.Title + '</a>';
                        }
                    },
                    { title: '类型', field: 'ModuleType', align: 'left', width: '140' },
                    {
                        title: '问题',
                        field: 'QuestionContent',
                        align: 'left',
                        width: '420',
                        formatter: function (value, row) {
                            return '<span title="' + row.QuestionContent + '">' + row.QuestionContent + '</span>';
                        }
                    },
                    {
                        title: '状态',
                        field: 'HasAnswer',
                        align: 'left',
                        width: '110',
                        formatter: function (value) {
                            switch (value) {
                                case 0:
                                    return '未回答';
                                case 1:
                                    return '已有回答';
                                default:
                                    return value;
                            }
                        }
                    },
                    {
                        title: '提问时间',
                        field: 'LastModifyTime',
                        align: 'left',
                        width: '100',
                        formatter: function (value, row) {
                            return getDateDiff(row.CurrentDateTime, row.LastModifyTime);
                        }
                    }
                ]
            });
        }

        function refreshQuestionCount() {
            parent.refreshDiscussCount();
            $('.dataList').GWDataTable('load');
        }
    </script>
</body>
</html>
