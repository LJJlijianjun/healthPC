<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>流转明细</title>
    <link href="../../assets/css/base.css" rel="stylesheet" />
    <link href="../../assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../assets/css/common.min.css?v=1.0.2" rel="stylesheet" />
    <style>
        td {
            word-wrap: break-word;
        }

        table {
            table-layout: fixed;
        }
    </style>
</head>
<body>
    <div>
        <table class="table table-condensed" id="wfProcessDetailTable">
            <thead>
                <tr class="h40" style="background-color: transparent;">
                    <td style="text-align: left; font-weight: bold;">任务名称</td>
                    <td style="text-align: left; font-weight: bold; width: 115px;">办理人</td>
                    <td style="text-align: left; font-weight: bold; width: 135px;">组织机构</td>
                    <td style="text-align: left; font-weight: bold; width: 96px;">任务到达时间</td>
                    <td style="text-align: left; font-weight: bold; width: 130px;">任务办理完成时间</td>
                    <td style="text-align: left; font-weight: bold; width: 85px;">任务状态</td>
                    <td style="text-align: left; font-weight: bold; width: 140px;">回退意见</td>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script src="../../assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="../../assets/js/jquery-tools-min.js" type="text/javascript"></script>
    <script src="../../assets/js/config.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/js/auth.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/LyncIM/LyncIM.js" type="text/javascript"></script>
    <script src="../../assets/js/workFlow.min.js?v=1.0.2" type="text/javascript"></script>
    <script src="../../assets/js/common.min.js?v=1.0.3" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            AuthUtility.Auth(function () {
                WorkflowEngine.GetProcessDetail(function (wFDetailData) {
                    if (wFDetailData && wFDetailData.length > 0) {
                        var wFDetailTbody = '';
                        $.each(wFDetailData, function (i, detail) {
                            var lyncImg = '<img style="cursor: pointer; margin-right: 5px; vertical-align: top; padding-top: 4px;" onload="IMNRC(\'' + detail.ItemArray[9] + '\')" id="' + detail.ItemArray[2] + '" name="imnmark" src="../../assets/vendors/LyncIM/images/IMNUNK.PNG" />';
                            var orgName = '';
                            if (detail.ItemArray[10]) orgName = detail.ItemArray[10];
                            if (detail.ItemArray[11]) {
                                if (orgName) {
                                    orgName = orgName + '&nbsp;->&nbsp;' + detail.ItemArray[11];
                                } else {
                                    orgName = detail.ItemArray[11];
                                }
                            }
                            if (!orgName) orgName = '-';

                            wFDetailTbody += '<tr class="h35">' +
                                                 '<td>' + detail.ItemArray[5] + '</td>' +
                                                 '<td>' + lyncImg + detail.ItemArray[7] + '</td>' +
                                                 '<td>' + orgName + '</td>' +
                                                 '<td style="text-align: center;">' + detail.ItemArray[3] + '</td>' +
                                                 '<td style="text-align: center;">' + (detail.ItemArray[4] > 3 ? detail.ItemArray[16] : '-') + '</td>' +
                                                 '<td>' + detail.ItemArray[8] + '</td>' +
                                                 '<td>' + (detail.ItemArray[4] === 6 ? detail.ItemArray[14] : '') + '</td>' +
                                             '</tr>';
                        });
                        $('#wfProcessDetailTable').find('tbody').html(wFDetailTbody);
                    }
                });
            });
        });
    </script>
</body>
</html>
