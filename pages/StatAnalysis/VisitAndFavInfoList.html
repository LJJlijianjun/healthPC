<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>阅览收藏信息列表</title>
    <link href="../../assets/css/base.css" rel="stylesheet" />
    <link href="../../assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/select2/dist/css/select2.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/gw-selectOrg/dist/gw-selectOrg.min.css?v=1.0.1" rel="stylesheet" />
    <link href="../../assets/vendors/smalot-bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/gw-selectSeason/src/gw-selectSeason.css" rel="stylesheet" />
    <link href="../../assets/vendors/iCheck/skins/square/blue.css" rel="stylesheet" />
    <link href="../../assets/vendors/LoadingUI/jquery.loadingui.css" rel="stylesheet" />
    <link href="../../assets/vendors/gw-dataTable/dist/gw-dataTable.min.css?v=1.0.1" rel="stylesheet" />
    <link href="../../assets/css/common.min.css?v=1.0.2" rel="stylesheet" />
    <link href="../../assets/css/statAnalysis.css??v=1.0.0" rel="stylesheet" />
</head>
<body class="stat-visitInfoList">
    <div class="modal-context">
        <div class="modal-head">
            <div class="modal-title">
                <span id="title-info"></span>
            </div>
            <button class="close" id="btnCloseModal" type="button" title="关闭">&times;</button>
        </div>
        <div class="modal-body">
            <div class="visitInfo-listView">
                <div class="dataList">
                </div>
            </div>
        </div>
    </div>
    <!--[if lt IE 9]>
    <script src="../../assets/vendors/html5shiv/dist/html5shiv.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/respond/src/respond.js" type="text/javascript"></script>
    <![endif]-->
    <script src="../../assets/vendors/jquery/dist/jquery.min.js"></script>
    <script src="../../assets/js/jquery-tools-min.js"></script>
    <script src="../../assets/js/config.min.js?v=1.0.0"></script>
    <script src="../../assets/js/auth.min.js?v=1.0.0"></script>
    <script src="../../assets/js/common.min.js?v=1.0.3"></script>
    <script src="../../assets/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="../../assets/vendors/gw-selectOrg/dist/gw-selectOrg.min.js?v=1.0.1" type="text/javascript"></script>
    <script src="../../assets/vendors/select2/dist/js/select2.full.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/smalot-bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/smalot-bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" type="text/javascript"></script>
    <script src="../../assets/vendors/gw-selectSeason/src/gw-selectSeason.js"></script>
    <script src="../../assets/vendors/iCheck/icheck.min.js"></script>
    <script src="../../assets/vendors/LoadingUI/jquery.loadingui.js"></script>
    <script src="../../assets/vendors/twbs-pagination/jquery.twbsPagination.js"></script>
    <script src="../../assets/vendors/gw-dataTable/dist/gw-dataTable.min.js?v=1.0.1"></script>
    <script src="../../assets/vendors/xss/dist/xss.min.js"></script>
    <script src="../../assets/vendors/platform.js/platform.js" type="text/javascript"></script>
    <script src="../../assets/vendors/bootbox.js/bootbox.js"></script>
    <script type="text/javascript">
        var ItemID = $.url().param('ItemID');
        var ModuleTypeKV = $.url().param('ModuleTypeKV');
        var StatType = $.url().param('StatType');
        var StatTypeValue = StatType == 1 ? '收藏次数' : StatType == 2 ? '阅读次数' : '阅读人次';
        var IsReportID = $.url().param('IsReportID');
        $('#title-info').text(StatTypeValue + '列表');

        var scModel = {
            ItemID: ItemID,
            ModuleTypeKV: ModuleTypeKV,
            StatTypeKV: StatType,
            IsReportID: IsReportID,
            PageNum: 1,
            PageSize: 0
        };

        $(function () {
            AuthUtility.Auth(function () {
                initEvent();
                initDataList();
            });
        });

        function initDataList() {
            $('.dataList').css('height', $('.stat-visitInfoList').height() - $('.modal-head').outerHeight(true));
            var option = {
                tableIcon: false,
                columns:
                [
                    {
                        title: '人员',
                        field: 'UserName',
                        align: 'left',
                        width: '120',
                        formatter: function (value) {
                            return '<span title="' + value + '">' + value + '</span>';
                        }
                    },
                    {
                        title: '机构',
                        field: 'UserTopOrgName',
                        align: 'left',
                        width: '180',
                        formatter: function (value) {
                            return '<span title="' + value + '">' + value + '</span>';
                        }
                    },
                    {
                        title: '部门',
                        field: 'UserOrgName',
                        align: 'left',
                        formatter: function (value) {
                            return value;
                        }
                    },

                    {
                        title: '时间',
                        field: 'ActionTime',
                        align: 'center',
                        width: '200',
                        formatter: function (value) {
                            return new Date(value.replace(/-/g, '/')).Format('yyyy-MM-dd HH:mm:ss');
                        }
                    }
                ],
                dataUrl: dataServiceBaseUrl + 'api/StatAnalysis/StatAnalysis/GetStatVisitAndFavInfoListBySC?sid=' + sid,
                queryParams: function (pageNumber, pageSize) {
                    scModel.PageNum = pageNumber;
                    scModel.PageSize = pageSize;
                    return { scModel: scModel };
                },
                pagination: true,
                pageSize: 8
            };

            $('.dataList').GWDataTable(option);
        }

        function initEvent() {
            $('#btnCloseModal').click(function () {
                $('#btnCloseVisitAndFavInfoModal', parent.document).click();
                return false;
            });
        }
    </script>
</body>
</html>
