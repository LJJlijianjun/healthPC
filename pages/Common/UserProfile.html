<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <link href="../../assets/css/base.css" rel="stylesheet" />
    <link href="../../assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../assets/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../../assets/css/common.min.css?v=1.0.2" rel="stylesheet" />
    <link href="../../assets/css/userProfile.min.css?v=1.0.0" rel="stylesheet" />
</head>
<body>
    <div class="userProfile">
        <div class="gwImage"></div>
        <div class="closeModal" title="关闭"></div>
        <div class="userPhotoContainer">
            <div class="userPhoto">
                <img alt="" />
            </div>
        </div>
        <div class="centerContent">
            <div class="userName"></div>
            <div class="line"></div>
        </div>
        <div class="userInfo">
            <div class="rowInfo">
                <div class="div1">编&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;号：</div>
                <div class="div2 serialNo"></div>
                <div class="div1">登录账号：</div>
                <div class="div2 account"></div>
            </div>
            <div class="rowInfo">
                <div class="div1">组织机构：</div>
                <div class="div2 organizeName textOverFlowEllipsis"></div>
                <div class="div1">职&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;务：</div>
                <div class="div2 position"></div>
            </div>
            <div class="rowInfo">
                <div class="div1">办公电话：</div>
                <div class="div2 telephone"></div>
                <div class="div1">住宅电话：</div>
                <div class="div2 homePhone"></div>
            </div>
            <div class="rowInfo">
                <div class="div1">移动电话：</div>
                <div class="div2 mobilePhone"></div>
                <div class="div1">邮&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;件：</div>
                <div class="div2 email textOverFlowEllipsis">
                    <a href="#" title="发送邮件"></a>
                </div>
            </div>
            <div class="rowInfo">
                <div class="div1">办公地址：</div>
                <div class="div3 address textOverFlowEllipsis"></div>
            </div>
        </div>
    </div>
    <script src="../../assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="../../assets/js/jquery-tools-min.js" type="text/javascript"></script>
    <script src="../../assets/js/config.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/js/auth.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../../assets/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../assets/vendors/velocity/velocity.min.js"></script>
    <script src="../../assets/js/common.min.js?v=1.0.3" type="text/javascript"></script>
    <script type="text/javascript">
        var userAccountId = $.url().param('userAccountId');

        $(function () {
            if (!userAccountId)
                return;

            AuthUtility.Auth(function () {
                bindEvent();
                loadUserProfile();
            });
        });

        function bindEvent() {
            $('.closeModal').on('mousedown', function () {
                $(this).velocity({
                    width: 28,
                    height: 26
                }, {
                    duration: 60,
                    easing: "swing",
                    complete: null
                });
            });

            $('.closeModal').on('mouseup', function () {
                $(this).velocity({
                    width: 30,
                    height: 28
                }, {
                    duration: 80,
                    easing: "swing",
                    complete: function () {
                        window.parent.closeUserProfile();
                    }
                });
            });
        }

        function loadUserProfile() {
            $.ajax({
                url: dataServiceBaseUrl + 'api/UserOrg/User/GetUserInfoPhotoByUserAccountID?userAccountId=' + userAccountId + '&sid=' + sid,
                type: 'get',
                cache: false,
                success: function (data) {
                    if (data && data.Success === true && data.Data) {
                        // 姓名
                        document.title = data.Data.MainUserInfo.Name;
                        $('.userName').text(data.Data.MainUserInfo.Name);

                        // 头像
                        if (data.Data.MainUserInfo.Photo) {
                            $('.userPhoto img').attr('src', 'data:image/png;base64,' + data.Data.MainUserInfo.Photo);
                        } else {
                            $('.userPhoto img').attr('src', '../../assets/img/UserProfile/userPhoto.jpg');
                        }
                        fitImage($('.userPhoto img'), 64, 70);

                        // 编号和登录账号
                        if (data.Data.MainUserInfo.SerialNo && data.Data.MainUserInfo.SerialNo != 'NULL') {
                            $('.serialNo').text(data.Data.MainUserInfo.SerialNo);
                        }
                        $('.account').text(data.Data.MainUserInfo.Account);

                        // 组织机构和职务
                        if (data.Data.MainUserInfo.Organize_Name && data.Data.MainUserInfo.Organize_Name != 'NULL') {
                            $('.organizeName').text(data.Data.MainUserInfo.Organize_Name).attr('title', data.Data.MainUserInfo.Organize_Name);
                        }
                        if (data.Data.MainUserInfo.Position && data.Data.MainUserInfo.Position != 'NULL') {
                            $('.position').text(data.Data.MainUserInfo.Position);
                        }

                        // 办公电话和住宅电话
                        if (data.Data.MainUserInfo.Telephone && data.Data.MainUserInfo.Telephone != 'NULL') {
                            $('.telephone').text(data.Data.MainUserInfo.Telephone);
                        }
                        if (data.Data.MainUserInfo.HomePhone && data.Data.MainUserInfo.HomePhone != 'NULL') {
                            $('.homePhone').text(data.Data.MainUserInfo.HomePhone);
                        }

                        // 移动电话和邮件
                        if (data.Data.MainUserInfo.MobilePhone && data.Data.MainUserInfo.MobilePhone != 'NULL') {
                            $('.mobilePhone').text(data.Data.MainUserInfo.MobilePhone);
                        }
                        if (data.Data.MainUserInfo.Email && data.Data.MainUserInfo.Email != 'NULL') {
                            $('.email a').text(data.Data.MainUserInfo.Email).attr('href', 'mailto:' + data.Data.MainUserInfo.Email);
                        }

                        // 办公地址
                        if (data.Data.MainUserInfo.Address && data.Data.MainUserInfo.Address != 'NULL') {
                            $('.address').text(data.Data.MainUserInfo.Address).attr('title', data.Data.MainUserInfo.Address);
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
