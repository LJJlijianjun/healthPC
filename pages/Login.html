<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>临时登录</title>
    <link href="../assets/css/base.css" rel="stylesheet" />
    <link href="../assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/common.min.css?v=1.0.2" rel="stylesheet" />
    <style type="text/css">
        .login {
            margin: 10% auto;
            padding: 20px;
            padding-top: 80px;
            width: 500px;
            height: 300px;
            border: 1px solid #66afe9;
            border-radius: 10px;
            text-align: center;
        }
    </style>
    <script type="text/javascript">
        try {
            window.moveTo(0, 0);
            window.resizeTo(window.screen.availWidth, window.screen.availHeight);
        } catch (e) {
        }
    </script>
</head>
<body>
    <div class="login">
        <p class="textLeft">用户名：</p>
        <input class="form-control" id="txtUserAccountID" type="text" placeholder="用户名..." />
        <button class="btn btn-primary btn-block mt20" id="btnLogin" data-loading-text="登录中..." type="button" onclick="login();">登录</button>
    </div>
    <script src="../assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="../assets/js/jquery-tools-min.js" type="text/javascript"></script>
    <script src="../assets/js/config.min.js?v=1.0.0" type="text/javascript"></script>
    <script src="../assets/js/common.min.js?v=1.0.3" type="text/javascript"></script>
    <script src="../assets/vendors/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $('#txtUserAccountID').on('keydown', function (e) {
                if (e.keyCode === 13) {
                    login();
                }
            });
        });

        var userAccountID;
        function login() {
            userAccountID = $('#txtUserAccountID').val().trim();
            if (!userAccountID) return;

            $.support.cors = true;
            $.ajax({
                type: 'get',
                url: dataServiceBaseUrl + 'api/Common/Auth',
                data: { 'userAccountID': userAccountID },
                dataType: 'json',
                async: true,
                cache: false,
                beforeSend: function () {
                    $('#txtUserAccountID').prop('disabled', true);
                    $('#btnLogin').button('loading').prop('disabled', true);
                },
                success: function (data) {
                    $('#txtUserAccountID').prop('disabled', false);
                    $('#btnLogin').button('reset').prop('disabled', false);

                    if (data.Success === true && data.Data) {
                        $.cookie('GWWealthPlatformBackendsid', encodeURIComponent(data.Data), { path: '/' });
                        window.location.href = 'Index.html';
                    } else {
                        //alert(data.Message);
                        //用户不存在或者没权限跳转到外网站点
                        window.location.href = GWWealthPlatformFrontendWebBaseUrl;
                    }
                },
                error: function (xhr, type, exception) {
                    alert('登录失败\r\nstatusText：' + xhr.statusText);
                    $('#txtUserAccountID').prop('disabled', false);
                    $('#btnLogin').button('reset').prop('disabled', false);
                }
            });
        }
    </script>
</body>
</html>